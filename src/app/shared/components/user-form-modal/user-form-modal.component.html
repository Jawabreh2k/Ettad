<app-modal [isOpen]="isOpen" [title]="title" (closed)="close()">
  <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="space-y-6">
    <!-- Username -->
    <div>
      <label class="block text-sm font-semibold text-[var(--color-text)] mb-2">
        Username <span class="text-[var(--color-error)]">*</span>
      </label>
      <input
        type="text"
        formControlName="userName"
        placeholder="Enter username or email"
        class="w-full px-4 py-2.5 border-2 border-[var(--color-border)] rounded-lg focus:outline-none focus:border-[var(--color-accent)] focus:ring-4 focus:ring-[var(--color-accent)]/10 transition-all"
        [class.border-[var(--color-error)]]="userForm.get('userName')?.invalid && userForm.get('userName')?.touched"
      />
      <p *ngIf="getFieldError('userName')" class="mt-2 text-sm text-[var(--color-error)]">
        {{ getFieldError('userName') }}
      </p>
    </div>

    <!-- Password (Create Mode Only) -->
    <div *ngIf="mode === 'create'">
      <label class="block text-sm font-semibold text-[var(--color-text)] mb-2">
        Password <span class="text-[var(--color-error)]">*</span>
      </label>
      <input
        type="password"
        formControlName="password"
        placeholder="Enter password"
        class="w-full px-4 py-2.5 border-2 border-[var(--color-border)] rounded-lg focus:outline-none focus:border-[var(--color-accent)] focus:ring-4 focus:ring-[var(--color-accent)]/10 transition-all"
        [class.border-[var(--color-error)]]="userForm.get('password')?.invalid && userForm.get('password')?.touched"
      />
      <p *ngIf="getFieldError('password')" class="mt-2 text-sm text-[var(--color-error)]">
        {{ getFieldError('password') }}
      </p>
    </div>

    <!-- Organization ID -->
    <div>
      <label class="block text-sm font-semibold text-[var(--color-text)] mb-2">
        Organization ID
      </label>
      <input
        type="number"
        formControlName="organizationId"
        placeholder="Enter organization ID"
        class="w-full px-4 py-2.5 border-2 border-[var(--color-border)] rounded-lg focus:outline-none focus:border-[var(--color-accent)] focus:ring-4 focus:ring-[var(--color-accent)]/10 transition-all"
      />
    </div>

    <!-- Employee ID -->
    <div>
      <label class="block text-sm font-semibold text-[var(--color-text)] mb-2">
        Employee ID
      </label>
      <input
        type="number"
        formControlName="employeeId"
        placeholder="Enter employee ID (optional)"
        class="w-full px-4 py-2.5 border-2 border-[var(--color-border)] rounded-lg focus:outline-none focus:border-[var(--color-accent)] focus:ring-4 focus:ring-[var(--color-accent)]/10 transition-all"
      />
    </div>

    <!-- Extra Employees View -->
    <div>
      <label class="block text-sm font-semibold text-[var(--color-text)] mb-2">
        Extra Employees View
      </label>
      <input
        type="text"
        formControlName="extraEmployeesView"
        placeholder="Enter extra employees view (optional)"
        class="w-full px-4 py-2.5 border-2 border-[var(--color-border)] rounded-lg focus:outline-none focus:border-[var(--color-accent)] focus:ring-4 focus:ring-[var(--color-accent)]/10 transition-all"
      />
    </div>

    <!-- LDAP User -->
    <div class="flex items-center gap-2">
      <input
        type="checkbox"
        id="isLdapUser"
        formControlName="isLdapUser"
        class="h-4 w-4 rounded border-2 border-[var(--color-border)] text-[var(--color-accent)] focus:ring-2 focus:ring-[var(--color-accent)]/20"
      />
      <label for="isLdapUser" class="text-sm font-medium text-[var(--color-text)]">
        LDAP User
      </label>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="bg-[var(--color-error)]/10 border border-[var(--color-error)] text-[var(--color-error)] px-4 py-3 rounded-lg">
      {{ errorMessage }}
    </div>

    <!-- Actions -->
    <div class="flex items-center justify-end gap-3 pt-4">
      <app-button
        type="button"
        variant="secondary"
        (click)="close()"
        [disabled]="isLoading"
      >
        Cancel
      </app-button>
      <app-button
        type="submit"
        variant="primary"
        [disabled]="isLoading || userForm.invalid"
      >
        {{ isLoading ? 'Saving...' : (mode === 'create' ? 'Create User' : 'Update User') }}
      </app-button>
    </div>
  </form>
</app-modal>
