<nav class="bg-[var(--color-brand)] shadow-custom-md h-16 flex items-center px-6 z-40">
  <div class="flex items-center justify-between w-full">
    <!-- Left side - Logo -->
    <div class="flex items-center">
      <img src="assets/logo.png" alt="Logo" class="h-10" />
    </div>

    <!-- Center - Title -->
    <div class="absolute left-1/2 transform -translate-x-1/2 max-w-xs sm:max-w-md md:max-w-lg lg:max-w-xl xl:max-w-2xl hidden sm:block">
      <h2 class="text-sm sm:text-base md:text-lg lg:text-xl xl:text-2xl font-bold text-[var(--color-text)] text-center truncate">{{ 'nav.integratedInventoryManagement' | translate }}</h2>
    </div>

    <!-- Right side - Actions -->
    <div class="flex items-center gap-4">
      <!-- Language Toggle -->
      <button
        (click)="toggleLanguage()"
        class="flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-white/20 transition-colors duration-200"
        aria-label="Change language"
      >
        <lucide-angular [img]="Languages" class="h-5 w-5 text-[var(--color-text)]"></lucide-angular>
        <span class="text-sm font-medium text-[var(--color-text)]">{{ getCurrentLanguage() }}</span>
      </button>

      <!-- Notifications -->
      <button
        (click)="navigateToNotifications()"
        class="relative p-2 rounded-lg hover:bg-white/20 transition-colors duration-200"
        aria-label="Notifications"
      >
        <lucide-angular [img]="Bell" class="h-5 w-5 text-[var(--color-text)]"></lucide-angular>
        <span *ngIf="notificationCount > 0" class="absolute top-1 h-5 w-5 bg-[var(--color-error)] rounded-full flex items-center justify-center"
              [class.right-1]="!isRTL" [class.left-1]="isRTL">
          <span class="text-xs font-bold text-white">{{ notificationCount }}</span>
        </span>
      </button>

      <!-- User Profile Dropdown -->
      <div class="relative">
        <button
          (click)="toggleUserMenu()"
          class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/20 transition-colors duration-200"
          aria-label="User profile"
        >
          <!-- User Avatar with Initials -->
          <div class="h-9 w-9 rounded-full bg-white flex items-center justify-center shadow-sm">
            <span class="text-sm font-bold text-[var(--color-brand)]">{{ getUserInitials() }}</span>
          </div>
          
          <!-- User Info (Hidden on mobile) -->
          <div class="hidden md:flex flex-col items-start">
            <span class="text-sm font-semibold text-[var(--color-text)]">{{ getUserFullName() }}</span>
            <span class="text-xs text-white/80">{{ getUserRole() }}</span>
          </div>
          
          <!-- Chevron -->
          <lucide-angular 
            [img]="ChevronDown" 
            class="h-4 w-4 text-white/80 transition-transform duration-200"
            [class.rotate-180]="showUserMenu"
          ></lucide-angular>
        </button>
        
        <!-- Dropdown Menu -->
        <div 
          *ngIf="showUserMenu"
          class="absolute mt-2 w-64 bg-white rounded-xl shadow-custom-lg border border-[var(--color-border)] animate-in fade-in slide-in-from-top-2 duration-200 z-50"
          [class.right-0]="!isRTL" [class.left-0]="isRTL"
          (click)="$event.stopPropagation()"
        >
          <!-- User Info in Dropdown -->
          <div class="px-4 py-3 border-b border-[var(--color-border)]">
            <div class="flex items-center gap-3">
              <div class="h-12 w-12 rounded-full bg-gradient-to-br from-[var(--color-accent)] to-[var(--color-accent-dark)] flex items-center justify-center shadow-sm">
                <span class="text-base font-bold text-white">{{ getUserInitials() }}</span>
              </div>
              <div class="flex-1 min-w-0">
                <p class="text-sm font-semibold text-[var(--color-text)] truncate">{{ getUserFullName() }}</p>
                <p class="text-xs text-[var(--color-text-muted)]">{{ getUserRole() }}</p>
                <p class="text-xs text-[var(--color-text-muted)] truncate">{{ currentUser?.email }}</p>
              </div>
            </div>
          </div>

          <!-- Menu Items -->
          <div class="py-2">
            <button
              (click)="navigateToProfile()"
              class="flex items-center gap-3 w-full px-4 py-2.5 text-sm text-[var(--color-text)] hover:bg-[var(--color-background-hover)] transition-colors"
            >
              <lucide-angular [img]="User" class="h-4 w-4 text-[var(--color-accent)]"></lucide-angular>
              <span class="font-medium">My Profile</span>
            </button>

            <button
              (click)="navigateToNotifications()"
              class="flex items-center gap-3 w-full px-4 py-2.5 text-sm text-[var(--color-text)] hover:bg-[var(--color-background-hover)] transition-colors"
            >
              <div class="relative">
                <lucide-angular [img]="Bell" class="h-4 w-4 text-[var(--color-accent)]"></lucide-angular>
                <span *ngIf="notificationCount > 0" class="absolute h-3 w-3 bg-[var(--color-error)] rounded-full"
                      [class.-top-1]="true" [class.-right-1]="!isRTL" [class.-left-1]="isRTL"></span>
              </div>
              <span class="font-medium">Notifications</span>
              <span *ngIf="notificationCount > 0" class="ml-auto text-xs font-semibold text-[var(--color-error)]">{{ notificationCount }}</span>
            </button>
          </div>

          <!-- Logout -->
          <div class="py-2 border-t border-[var(--color-border)]">
            <button
              (click)="logout()"
              class="flex items-center gap-3 w-full px-4 py-2.5 text-sm text-[var(--color-error)] hover:bg-[var(--color-error)]/5 transition-colors"
            >
              <lucide-angular [img]="LogOut" class="h-4 w-4"></lucide-angular>
              <span class="font-medium">Sign Out</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

<!-- Overlay to close menu when clicking outside -->
<div 
  *ngIf="showUserMenu"
  (click)="closeUserMenu()"
  class="fixed inset-0 z-30"
></div>
